# Lesson 3.2: Confirming pgAdmin Setup and Running Your First SQL

## What is pgAdmin?

**pgAdmin** is a free, open-source graphical tool (GUI) for working with PostgreSQL databases.

**What pgAdmin does:**
- Visual interface to interact with PostgreSQL (instead of command line)
- Browse databases, tables, and data visually
- ✍️ Write and execute SQL queries
- 🔍 View query results in tables
- 🏗️ Create/modify database objects (tables, users, etc.)
- 📈 Monitor database performance

**Think of pgAdmin as:**
- Microsoft Word for databases (instead of writing in Notepad)
- A friendly interface that makes database work easier

---

## Opening pgAdmin

### **Windows:**
1. Click Start menu
2. Search for "pgAdmin 4"
3. Click to open

### **Mac:**
1. Open Applications folder
2. Find pgAdmin 4
3. Double-click to launch

### **Linux:**
```bash
pgadmin4
```

**First time opening pgAdmin:**
- It may take 30-60 seconds to load (starting the pgAdmin server)
- Your web browser will open automatically
- You'll see the pgAdmin interface in your browser

**Yes, pgAdmin runs in your browser!** It's a web application that runs locally on your computer.

---

## Setting a Master Password (First Time Only)

When you open pgAdmin for the first time, you'll be asked to set a **master password**.

**What is this password for?**
- It protects access to pgAdmin itself
- It's different from your PostgreSQL database password
- You'll enter it each time you open pgAdmin

**Recommendation:**
- Use a simple password for this course (e.g., `pgadmin123`)
- Write it down! You'll need it every session.

---

## Connecting to PostgreSQL Server

### **Step 1: Locate Your PostgreSQL Server**

In the pgAdmin sidebar (left side), you should see:
```
pgAdmin 4
└── Servers
    └── PostgreSQL 16 (or 15, 14 depending on your version)
```

**If you don't see "Servers" or "PostgreSQL":**
- You may need to register a server manually
- Follow the "Troubleshooting" section at the end of this lesson

---

### **Step 2: Expand Your Server**

Click the **arrow ** next to "PostgreSQL 16" to expand it.

**You'll be prompted for a password.**

**This is your PostgreSQL database password** (the one you set during PostgreSQL installation, NOT your pgAdmin master password).

**Common default passwords:**
- `postgres` (if you didn't set one during install)
- The password you chose during installation
- `postgres123` (if you followed our setup guide)

**Enter the password and click OK.**

**✅ If successful:** The server expands and you see:
```
PostgreSQL 16
├── Databases (X)
├── Login/Group Roles
├── Tablespaces
└── ...
```

**❌ If it fails:** See troubleshooting section below.

---

### **Step 3: View Databases**

Expand **"Databases"** by clicking the arrow.

You should see at least:
```
Databases (3)
├── postgres       ← Default system database
├── template0      ← Template (don't touch)
└── template1      ← Template (don't touch)
```

**The `postgres` database** is the default database created during installation. We'll create our own database next, but this confirms PostgreSQL is working!

---

## Creating Your First Database

We'll create a database called `ecommerce_db` for this course.

### **Method 1: Using pgAdmin GUI (Recommended for beginners)**

**Step 1:** Right-click on **"Databases"**

**Step 2:** Select **"Create" → "Database..."**

**Step 3:** In the dialog that appears:
- **Database name:** `ecommerce_db`
- **Owner:** `postgres` (default, leave as is)
- **Comment:** "Data Engineering Course Database" (optional)

**Step 4:** Click **"Save"**

**✅ Success!** You should now see:
```
Databases (4)
├── ecommerce_db   ← Your new database!
├── postgres
├── template0
└── template1
```

---

### **Method 2: Using SQL Command (Advanced)**

Alternatively, you can create the database using SQL.

**Step 1:** Right-click on **"PostgreSQL 16"** (your server)

**Step 2:** Select **"Query Tool"**

**Step 3:** In the query editor that opens, type:
```sql
CREATE DATABASE ecommerce_db;
```

**Step 4:** Click the **Execute button (▶️)** or press **F5**

**Step 5:** Check the "Messages" tab at the bottom:
```
Query returned successfully in 52 msec.
```

**Step 6:** Refresh the database list:
- Right-click "Databases" → "Refresh"
- You should now see `ecommerce_db`

---

## Opening the Query Tool

The **Query Tool** is where you'll write and run all your SQL queries.

**How to open it:**

**Step 1:** In the sidebar, expand:
```
PostgreSQL 16
└── Databases
    └── ecommerce_db
```

**Step 2:** Right-click on **ecommerce_db**

**Step 3:** Select **"Query Tool"**

**A new tab opens** with a text editor where you can write SQL!

**The Query Tool has 3 main areas:**

1. **SQL Editor (top)** - Where you write queries
2. **Data Output (bottom)** - Where results appear
3. **Messages (bottom tab)** - Shows success/error messages

---

## Your First SQL Query

Let's run your first SQL command!

### **Query 1: Check PostgreSQL Version**

In the Query Tool, type:
```sql
SELECT version();
```

**Click the Execute button (▶️)** or press **F5**.

**Result (in Data Output tab):**
```
version
PostgreSQL 16.1 on x86_64-pc-linux-gnu, compiled by gcc...
```

**What this tells you:**
- ✅ PostgreSQL is working
- ✅ You can run SQL queries
- ✅ You're using PostgreSQL version 16 (or 15, 14, etc.)

---

### **Query 2: Get Current Date and Time**

Clear the editor and type:
```sql
SELECT CURRENT_DATE, CURRENT_TIMESTAMP;
```

**Execute (F5).**

**Result:**
```
current_date  | current_timestamp
2025-02-02    | 2025-02-02 14:30:15.123456+01:00
```

**What this does:**
- `CURRENT_DATE` returns today's date
- `CURRENT_TIMESTAMP` returns current date and time with timezone

---

### **Query 3: Simple Math**
```sql
SELECT 2 + 2 AS addition,
       10 - 3 AS subtraction,
       5 * 4 AS multiplication,
       20 / 4 AS division;
```

**Execute.**

**Result:**
```
addition | subtraction | multiplication | division
4        | 7           | 20             | 5
```

**What this shows:**
- SQL can do calculations
- `AS` gives names to columns (aliases)
- You can select multiple calculated values at once

---

### **Query 4: String Concatenation**
```sql
SELECT 'Hello' || ' ' || 'World!' AS greeting;
```

**Execute.**

**Result:**
```
greeting
Hello World!
```

**What this shows:**
- `||` is the concatenation operator in PostgreSQL (joins strings)
- Single quotes `'...'` are used for text values

---

## Creating Your First Table

Now let's create an actual table to store data.

### **Step 1: Create a Simple Table**

In the Query Tool, type:
```sql
CREATE TABLE students (
    student_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    email VARCHAR(100),
    signup_date DATE
);
```

**Execute (F5).**

**Message:**
```
Query returned successfully in 45 msec.
```

**What this does:**
- Creates a table named `students`
- Defines 5 columns with different data types
- `SERIAL` = auto-incrementing integer (1, 2, 3, ...)
- `PRIMARY KEY` = unique identifier for each row
- `VARCHAR(50)` = text up to 50 characters
- `DATE` = date values (YYYY-MM-DD)

---

### **Step 2: Verify the Table Exists**

**Option 1: Using pgAdmin GUI**

In the sidebar:
```
ecommerce_db
└── Schemas
    └── public
        └── Tables
            └── students  ← Your new table!
```

Right-click `students` → "View/Edit Data" → "All Rows" to see the table structure.

**Option 2: Using SQL**
```sql
SELECT * FROM students;
```

**Result:**
```
(No rows)
```

Table exists but is empty (we haven't inserted data yet).

---

### **Step 3: Insert Data**

Add some students:
```sql
INSERT INTO students (first_name, last_name, email, signup_date)
VALUES 
    ('Ahmed', 'Hassan', 'ahmed@email.com', '2024-01-15'),
    ('Chioma', 'Obi', 'chioma@email.com', '2024-02-20'),
    ('Emeka', 'Nwosu', 'emeka@email.com', '2024-03-10');
```

**Execute.**

**Message:**
```
INSERT 0 3
Query returned successfully in 12 msec.
```

**"INSERT 0 3" means:** 3 rows were inserted successfully.

---

### **Step 4: Query the Data**

Now let's see the data:
```sql
SELECT * FROM students;
```

**Execute.**

**Result:**
```
student_id | first_name | last_name | email              | signup_date
1          | Ahmed      | Hassan    | ahmed@email.com    | 2024-01-15
2          | Chioma     | Obi       | chioma@email.com   | 2024-02-20
3          | Emeka      | Nwosu     | emeka@email.com    | 2024-03-10
```

**🎉 Congratulations!** You've:
- ✅ Created a database
- ✅ Created a table
- ✅ Inserted data
- ✅ Queried data

**You just did real data engineering work!**

---

## Understanding pgAdmin Query Tool Features

### **Execute Button (▶️)**
- Runs the SQL query
- Keyboard shortcut: **F5**

### **Clear Query Editor (🗑️)**
- Erases everything in the editor
- Use when starting a new query

### **Save Query (💾)**
- Saves your SQL to a file (.sql)
- Useful for keeping queries you want to reuse

### **Download Results (⬇️)**
- Export query results to CSV, Excel, JSON
- Found below the results table

### **Query History**
- View → "Query History"
- Shows all queries you've run

### **Multiple Tabs**
- You can open multiple Query Tools simultaneously
- File → Query Tool (or Ctrl+T / Cmd+T)

---

## Common pgAdmin Operations

### **Viewing Table Structure**

**Option 1: Using GUI**
```
Tables → students → Columns
```

**Option 2: Using SQL**
```sql
\d students
```
(This is a PostgreSQL command-line shortcut, works in Query Tool too)

Or:
```sql
SELECT column_name, data_type, character_maximum_length
FROM information_schema.columns
WHERE table_name = 'students';
```

---

### **Deleting a Table**

**GUI:** Right-click table → "Delete/Drop" → Confirm

**SQL:**
```sql
DROP TABLE students;
```

**⚠️ Warning:** This permanently deletes the table and ALL its data!

---

### **Backing Up a Database**

**Right-click on `ecommerce_db`** → "Backup..."
- Choose location to save `.sql` file
- This creates a full backup you can restore later

---

## Troubleshooting Common Issues

### **Issue 1: "password authentication failed for user postgres"**

**Cause:** Wrong database password

**Fix:**
1. Right-click server → "Disconnect"
2. Right-click server → "Properties"
3. Go to "Connection" tab
4. Re-enter the correct password
5. Save and reconnect

**If you forgot the password:**
- You may need to reset it using command line
- Post in WhatsApp group for help with specific OS instructions

---

### **Issue 2: "server closed the connection unexpectedly"**

**Cause:** PostgreSQL service isn't running

**Fix:**

**Windows:**
1. Open Services app
2. Find "postgresql-x64-16"
3. Right-click → Start

**Mac:**
```bash
brew services start postgresql@16
```

**Linux:**
```bash
sudo systemctl start postgresql
```

---

### **Issue 3: Server not showing in pgAdmin**

**Cause:** Server not registered

**Fix - Add Server Manually:**

1. Right-click "Servers" → "Register" → "Server"
2. **General tab:**
   - Name: `PostgreSQL 16`
3. **Connection tab:**
   - Host: `localhost`
   - Port: `5432`
   - Maintenance database: `postgres`
   - Username: `postgres`
   - Password: [your password]
   - Save password: ✅ (check this)
4. Click "Save"

---

### **Issue 4: Query Tool is slow or freezing**

**Causes:**
- Too many rows being returned (millions)
- Complex query running

**Solutions:**
- Use `LIMIT` to restrict results:
```sql
  SELECT * FROM large_table LIMIT 100;
```
- Cancel running query: Click "Stop" button (⏹️) or press Alt+Break

---

### **Issue 5: "relation [table_name] does not exist"**

**Cause:** You're connected to wrong database

**Fix:**
- Check which database is selected in the sidebar
- Make sure you're querying the database where the table exists
- Tables in `ecommerce_db` won't be visible if you're connected to `postgres` database

---

## Best Practices for Using pgAdmin

### **1. Always select the correct database**

Before running queries, verify you're connected to the right database in the sidebar.

### **2. Save important queries**

- Click Save button (💾)
- Name your files descriptively: `create_students_table.sql`
- Keep a folder: `course-sql-queries/`

### **3. Use semicolons**

Always end SQL statements with `;`
```sql
SELECT * FROM students;  ← Semicolon here
```

### **4. Format your SQL for readability**

**Bad:**
```sql
select first_name,last_name,email from students where signup_date>'2024-01-01' order by last_name;
```

**Good:**
```sql
SELECT first_name, last_name, email
FROM students
WHERE signup_date > '2024-01-01'
ORDER BY last_name;
```

### **5. Comment your queries**
```sql
-- This query finds all students who signed up in 2024
SELECT *
FROM students
WHERE signup_date >= '2024-01-01';
```

Use `--` for single-line comments  
Use `/* ... */` for multi-line comments

---

## Quick Reference: SQL Execution

**To run a query:**
1. Type SQL in the editor
2. Press **F5** or click **Execute button (▶️)**
3. View results in "Data Output" tab below
4. Check "Messages" tab for errors or confirmation

**To run part of a query:**
1. Highlight the SQL you want to run
2. Press F5
3. Only the highlighted part executes

**Useful when you have multiple queries in one file.**

---

## Summary: What You've Learned

✅ **pgAdmin basics** - How to navigate the interface  
✅ **Connect to PostgreSQL** - Access your database server  
✅ **Create a database** - `ecommerce_db`  
✅ **Use Query Tool** - Where you'll write all SQL  
✅ **Run SQL commands** - SELECT, CREATE TABLE, INSERT  
✅ **Create tables and insert data** - Real database operations  
✅ **Troubleshoot common issues** - Fix connection problems  

---

## Practice Exercise

Before the next lesson, practice these tasks:

**Task 1:** Create a table called `products`
```sql
CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    product_name VARCHAR(100),
    price DECIMAL(10, 2),
    stock_quantity INT
);
```

**Task 2:** Insert 3 products
```sql
INSERT INTO products (product_name, price, stock_quantity)
VALUES 
    ('Laptop', 500000.00, 10),
    ('Mouse', 5000.00, 50),
    ('Keyboard', 15000.00, 30);
```

**Task 3:** Query all products
```sql
SELECT * FROM products;
```

**Task 4:** Find products cheaper than ₦20,000
```sql
SELECT * FROM products WHERE price < 20000;
```

**If all 4 tasks work, you're ready for the next lesson!**

---

**Next Lesson:** We'll dive deep into SELECT, WHERE, ORDER BY, and LIMIT - the foundation of all SQL querying!

